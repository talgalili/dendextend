<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frequently asked questions • dendextend</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Frequently asked questions">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.18.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/talgalili/dendextend/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Frequently asked questions</h1>
                        <h4 data-toc-skip class="author">Tal Galili</h4>
            
            <h4 data-toc-skip class="date">2024-11-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/talgalili/dendextend/blob/master/vignettes/FAQ.Rmd" class="external-link"><code>vignettes/FAQ.Rmd</code></a></small>
      <div class="hidden name"><code>FAQ.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Frequently asked questions}
-->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Questions are often taken from here the <a href="https://stackoverflow.com/questions/tagged/dendrogram+r" class="external-link">stackoverflow
<code>dendrogram</code> tag</a>.</p>
<div class="section level3">
<h3 id="how-to-colour-the-labels-of-a-dendrogram-by-an-additional-factor-variable">How to colour the labels of a dendrogram by an additional factor
variable<a class="anchor" aria-label="anchor" href="#how-to-colour-the-labels-of-a-dendrogram-by-an-additional-factor-variable"></a>
</h3>
<p>Asked (<a href="https://stackoverflow.com/questions/27485549/how-to-colour-the-labels-of-a-dendrogram-by-an-additional-factor-variable-in-r" class="external-link uri">https://stackoverflow.com/questions/27485549/how-to-colour-the-labels-of-a-dendrogram-by-an-additional-factor-variable-in-r</a>)[here].</p>
<p>Solution: use the <code>labels_colors</code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("dendextend")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Like: </span></span>
<span><span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span></span>
<span></span>
<span><span class="co"># By default, the dend has no colors to the labels</span></span>
<span><span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span>, main <span class="op">=</span> <span class="st">"Original dend"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># let's add some color:</span></span>
<span><span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="co"># Now each state has a color</span></span>
<span><span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##   Arkansas    Arizona California    Alabama     Alaska </span></span>
<span><span class="co">##          1          2          3          4          5</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span>, main <span class="op">=</span> <span class="st">"A color for every state"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-2-1.png" width="600"></p>
<p>Instead of using <code>1:5</code>, we can obviously use colors that
are based on another factor (organized): the labels themselves. But in
such a case, we want to map between the order of the labels and the
order of the items in the original dataset. Here is another example
based on the iris dataset:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("dendextend")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">small_iris</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">51</span>, <span class="fl">101</span>, <span class="fl">2</span>, <span class="fl">52</span>, <span class="fl">102</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">small_iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Like: </span></span>
<span><span class="co"># dend &lt;- small_iris[,-5] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span></span>
<span></span>
<span><span class="co"># By default, the dend has no colors to the labels</span></span>
<span><span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span>, main <span class="op">=</span> <span class="st">"Original dend"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Let's add some color:</span></span>
<span><span class="va">colors_to_use</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">small_iris</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">colors_to_use</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 2 3 1 2 3</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># But sort them based on their order in dend:</span></span>
<span><span class="va">colors_to_use</span> <span class="op">&lt;-</span> <span class="va">colors_to_use</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/order.dendrogram.html" class="external-link">order.dendrogram</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">colors_to_use</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 1 2 2 3 3</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Now we can use them</span></span>
<span><span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">colors_to_use</span></span>
<span><span class="co"># Now each state has a color</span></span>
<span><span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##   1   2  51  52 101 102 </span></span>
<span><span class="co">##   1   1   2   2   3   3</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span>, main <span class="op">=</span> <span class="st">"A color for every Species"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-3-1.png" width="600"></p>
</div>
<div class="section level3">
<h3 id="how-to-color-a-dendrograms-labels-according-to-defined-groups-in-r">How to color a dendrogram’s labels according to defined groups? (in
R)<a class="anchor" aria-label="anchor" href="#how-to-color-a-dendrograms-labels-according-to-defined-groups-in-r"></a>
</h3>
<p>Asked (<a href="https://stackoverflow.com/questions/31117849/how-to-color-a-dendrograms-labels-according-to-defined-groups-in-r" class="external-link uri">https://stackoverflow.com/questions/31117849/how-to-color-a-dendrograms-labels-according-to-defined-groups-in-r</a>)[here].</p>
<p>Solution: use the <code>color_labels</code> function.</p>
<p>I suspect the function you are looking for is either
<code>color_labels</code> or <code>get_leaves_branches_col</code>. The
first color your labels based on <code>cutree</code> (like
<code>color_branches</code> do) and the second allows you to get the
colors of the branch of each leaf, and then use it to color the labels
of the tree (if you use unusual methods for coloring the branches (as
happens when using <code>branches_attr_by_labels</code>). For
example:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># define dendrogram object to play with:</span></span>
<span> <span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span>, <span class="st">"ave"</span><span class="op">)</span></span>
<span> <span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">hc</span><span class="op">)</span></span>
<span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="va">dend</span> <span class="op">&lt;-</span> <span class="va">dend</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="../reference/set.html">set</a></span><span class="op">(</span><span class="st">"branches_lwd"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>          <span class="fu"><a href="../reference/set.html">set</a></span><span class="op">(</span><span class="st">"branches_lty"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span> </span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span>
<span></span>
<span> <span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/color_labels.html">color_labels</a></span><span class="op">(</span><span class="va">dend</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span> <span class="co"># The same as:</span></span>
<span> <span class="co"># labels_colors(dend)  &lt;- get_leaves_branches_col(dend)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-4-1.png" width="450"></p>
<p>Either way, you should always have a look at the <code>set</code>
function, for ideas on what can be done to your dendrogram (this saves
the hassle of remembering all the different functions names).</p>
</div>
<div class="section level3">
<h3 id="how-to-color-a-dendrograms-brancheslabels-based-on-cluster-i-e--cutree-result">How to color a dendrogram’s branches/labels based on cluster (i.e.:
cutree result)<a class="anchor" aria-label="anchor" href="#how-to-color-a-dendrograms-brancheslabels-based-on-cluster-i-e--cutree-result"></a>
</h3>
<p>Use the <code>color_branches</code> and <code>color_labels</code>
functions, with the <code>k</code> (or<code>h</code>) parameter:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("dendextend")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Like: </span></span>
<span><span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span></span>
<span></span>
<span><span class="va">dend1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span><span class="op">(</span><span class="va">dend</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">dend2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/color_labels.html">color_labels</a></span><span class="op">(</span><span class="va">dend</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend1</span>, main <span class="op">=</span> <span class="st">"Colored branches"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend2</span>, main <span class="op">=</span> <span class="st">"Colored labels"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-5-1.png" width="600"></p>
</div>
<div class="section level3">
<h3 id="change-dendrograms-labels">Change dendrogram’s labels<a class="anchor" aria-label="anchor" href="#change-dendrograms-labels"></a>
</h3>
<p>Use the left assign <code>labels&lt;-</code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("dendextend")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Like: </span></span>
<span><span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Arkansas"   "Arizona"    "California" "Alabama"    "Alaska"</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 2 3 4 5</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="larger-font-for-leaves-in-a-dendrogram">Larger font for leaves in a dendrogram<a class="anchor" aria-label="anchor" href="#larger-font-for-leaves-in-a-dendrogram"></a>
</h3>
<p>Asked (<a href="https://stackoverflow.com/questions/26965390/larger-font-and-spacing-between-leaves-in-r-dendrogram" class="external-link uri">https://stackoverflow.com/questions/26965390/larger-font-and-spacing-between-leaves-in-r-dendrogram</a>)[here].</p>
<p>Solution: use the <code>set</code> function, with the “labels_cex”
parameter.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("dendextend")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Like: </span></span>
<span><span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span></span>
<span></span>
<span><span class="co"># By default, the dend has no text size to it (showing only the first leaf)</span></span>
<span><span class="fu"><a href="../reference/get_leaves_nodePar.html">get_leaves_nodePar</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] NA</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span>, main <span class="op">=</span> <span class="st">"Original dend"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># let's increase the size of the labels:</span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set.html">set</a></span><span class="op">(</span><span class="va">dend</span>, <span class="st">"labels_cex"</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Now each state has a larger label</span></span>
<span><span class="fu"><a href="../reference/get_leaves_nodePar.html">get_leaves_nodePar</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## $lab.cex</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pch</span></span>
<span><span class="co">## [1] NA</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span>, main <span class="op">=</span> <span class="st">"A larger font for labels"</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-7-1.png" width="600"></p>
<p>(Note that changing the spacing between the labels is currently not
implemented)</p>
</div>
<div class="section level3">
<h3 id="how-to-view-attributes-of-a-dendrogram">How to view attributes of a dendrogram<a class="anchor" aria-label="anchor" href="#how-to-view-attributes-of-a-dendrogram"></a>
</h3>
<p>Asked (<a href="https://stackoverflow.com/questions/26240200/how-to-access-attributes-of-a-dendrogram-in-r" class="external-link uri">https://stackoverflow.com/questions/26240200/how-to-access-attributes-of-a-dendrogram-in-r</a>)[here],
and (<a href="https://stackoverflow.com/questions/25664911/r-hclust-height-of-final-merge" class="external-link uri">https://stackoverflow.com/questions/25664911/r-hclust-height-of-final-merge</a>)[here].</p>
<p>It generally depends on which attribute we want to view. For
“midpoint” (or height) use the <code>get_nodes_attr</code> function,
with the “midpoint” parameter.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("dendextend")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Like: </span></span>
<span><span class="co"># dend &lt;- USArrests[1:5,] %&gt;% dist %&gt;% hclust %&gt;% as.dendrogram</span></span>
<span></span>
<span><span class="co"># midpoint for all nodes</span></span>
<span><span class="fu"><a href="../reference/get_nodes_attr.html">get_nodes_attr</a></span><span class="op">(</span><span class="va">dend</span>, <span class="st">"midpoint"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.25   NA 1.50 0.50   NA   NA 0.50   NA   NA</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perhaps also for the height:</span></span>
<span><span class="fu"><a href="../reference/get_nodes_attr.html">get_nodes_attr</a></span><span class="op">(</span><span class="va">dend</span>, <span class="st">"height"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 108.85192   0.00000  63.00833  23.19418   0.00000   0.00000  37.17701</span></span>
<span><span class="co">## [8]   0.00000   0.00000</span></span></code></pre>
<p>To also change an attribute, you can use the various assign functions
from the package: <code>assign_values_to_leaves_nodePar</code>,
<code>assign_values_to_leaves_edgePar</code>,
<code>assign_values_to_nodes_nodePar</code>,
<code>assign_values_to_branches_edgePar</code>,
<code>remove_branches_edgePar</code>,
<code>remove_nodes_nodePar</code></p>
</div>
<div class="section level3">
<h3 id="how-to-color-the-branches-in-heatmap-2">How to color the branches in heatmap.2?<a class="anchor" aria-label="anchor" href="#how-to-color-the-branches-in-heatmap-2"></a>
</h3>
<p>Asked (<a href="https://stackoverflow.com/questions/29265536/how-to-color-the-branches-and-tick-labels-in-the-heatmap-2" class="external-link uri">https://stackoverflow.com/questions/29265536/how-to-color-the-branches-and-tick-labels-in-the-heatmap-2</a>?)[here].</p>
<p>Solution: use the <code>color_branches</code> function (or the
<code>set</code> function, with the “branches_k_color”, “k”, and “value”
parameters).</p>
<p>(Getting the data for this example is from the (<a href="https://stackoverflow.com/questions/29265536/how-to-color-the-branches-and-tick-labels-in-the-heatmap-2" class="external-link uri">https://stackoverflow.com/questions/29265536/how-to-color-the-branches-and-tick-labels-in-the-heatmap-2</a>)[original
SO question])</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">test0</span></span>
<span><span class="va">rnames</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> </span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># to matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">rnames</span>                 </span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">test</span>, center<span class="op">=</span><span class="cn">T</span>, scale<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co"># data standarization</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="co"># transpose</span></span>
<span></span>
<span></span>
<span><span class="co">## Creating a color palette &amp; color breaks</span></span>
<span></span>
<span><span class="va">my_palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forestgreen"</span>, <span class="st">"yellow"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">299</span><span class="op">)</span></span>
<span></span>
<span><span class="va">col_breaks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">0.5</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,  <span class="co"># forestgreen</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, <span class="co"># yellow</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>    <span class="co"># red</span></span>
<span></span>
<span><span class="co"># distance &amp; hierarchical clustering</span></span>
<span><span class="va">distance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">test</span>, method <span class="op">=</span><span class="st">"euclidean"</span><span class="op">)</span>    </span>
<span><span class="va">hcluster</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">distance</span>, method <span class="op">=</span><span class="st">"ward.D"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">dend1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">hcluster</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the dendextend package</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"dendextend"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span><span class="co"># get some colors</span></span>
<span><span class="va">cols_branches</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"forestgreen"</span>, <span class="st">"orange"</span>, <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="co"># Set the colors of 4 branches</span></span>
<span><span class="va">dend1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span><span class="op">(</span><span class="va">dend1</span>, k <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="va">cols_branches</span><span class="op">)</span></span>
<span><span class="co"># or with:</span></span>
<span><span class="co"># dend1 &lt;- set(dend1, "branches_k_color", k = 4, value = cols_branches)</span></span>
<span></span>
<span><span class="co"># Get the colors of the tips of the dendrogram:</span></span>
<span><span class="co"># col_labels &lt;- cols_branches[cutree(dend1, k = 4)] # this may need tweaking in various cases - the following is a more general solution.</span></span>
<span></span>
<span><span class="va">col_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_leaves_branches_col.html">get_leaves_branches_col</a></span><span class="op">(</span><span class="va">dend1</span><span class="op">)</span></span>
<span><span class="co"># But due to the way heatmap.2 works - we need to fix it to be in the </span></span>
<span><span class="co"># order of the data!   </span></span>
<span><span class="va">col_labels</span> <span class="op">&lt;-</span> <span class="va">col_labels</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/order.dendrogram.html" class="external-link">order.dendrogram</a></span><span class="op">(</span><span class="va">dend1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dend1</span></span>
<span><span class="co"># plot(dend1)</span></span>
<span><span class="co"># a &lt;- heights_per_k.dendrogram(dend1)</span></span>
<span><span class="co"># a2 &lt;- heights_per_k.dendrogram(dend1)</span></span>
<span><span class="co"># nleaves(dend1)</span></span>
<span></span>
<span></span>
<span><span class="co"># Creating Heat Map</span></span>
<span><span class="co"># if(!require(gplots)) install.packages("gplots")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/talgalili/gplots" class="external-link">gplots</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://talgalili.github.io/gplots/reference/heatmap.2.html" class="external-link">heatmap.2</a></span><span class="op">(</span><span class="va">test</span>,  </span>
<span>    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span> <span class="st">"test"</span><span class="op">)</span>,  </span>
<span>        trace<span class="op">=</span><span class="st">"none"</span>,          </span>
<span>        margins <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">7</span><span class="op">)</span>,      </span>
<span>        col<span class="op">=</span><span class="va">my_palette</span>,        </span>
<span>        breaks<span class="op">=</span><span class="va">col_breaks</span>,     </span>
<span>        dendrogram<span class="op">=</span><span class="st">"row"</span>,      </span>
<span>        Rowv <span class="op">=</span> <span class="va">dend1</span>,  </span>
<span>        Colv <span class="op">=</span> <span class="st">"NA"</span>, </span>
<span>        key.xlab <span class="op">=</span> <span class="st">"Concentration (index)"</span>,</span>
<span>        cexRow <span class="op">=</span><span class="fl">0.6</span>,</span>
<span>        cexCol <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>        na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        RowSideColors <span class="op">=</span> <span class="va">col_labels</span> <span class="co"># to add nice colored strips     </span></span>
<span>      <span class="co"># colRow = col_labels # to add nice colored labels - only for qplots 2.17.0 and higher</span></span>
<span>        <span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="for-package-developers---how-to-call-imported-calls-from-dendextend-0-18-3">For package developers - how to call imported calls from dendextend
0.18.3?<a class="anchor" aria-label="anchor" href="#for-package-developers---how-to-call-imported-calls-from-dendextend-0-18-3"></a>
</h3>
<p>If you are developing a package and you wish to use dendextend as an
imported package, that is - without loading it to the search path, you
should run:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dendextend</span><span class="fu">::</span><span class="fu"><a href="../reference/assign_dendextend_options.html">assign_dendextend_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># This populates the dendextend::dendextend_options() space</span></span></code></pre></div>
<p>Before using any of its function (for example:
<code><a href="../reference/color_branches.html">dendextend::color_branches</a></code> ). As of dendextend version
1.0.0, this is no longer required.</p>
</div>
<div class="section level3">
<h3 id="how-to-plot-a-fan-polar-dendrogram-in-r">How to plot a fan (Polar) Dendrogram in R?<a class="anchor" aria-label="anchor" href="#how-to-plot-a-fan-polar-dendrogram-in-r"></a>
</h3>
<p>Asked (<a href="https://stats.stackexchange.com/questions/4062/how-to-plot-a-fan-polar-dendrogram-in-r" class="external-link uri">https://stats.stackexchange.com/questions/4062/how-to-plot-a-fan-polar-dendrogram-in-r</a>)[here].</p>
<p>Solution: use the <code>circlize_dendrogram</code> function.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("dendextend")</span></span>
<span><span class="co"># install.packages("circlize")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/circlize" class="external-link">circlize</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ========================================</span></span>
<span><span class="co">## circlize version 0.4.16</span></span>
<span><span class="co">## CRAN page: https://cran.r-project.org/package=circlize</span></span>
<span><span class="co">## Github page: https://github.com/jokergoo/circlize</span></span>
<span><span class="co">## Documentation: https://jokergoo.github.io/circlize_book/book/</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## If you use it in published research, please cite:</span></span>
<span><span class="co">## Gu, Z. circlize implements and enhances circular visualization</span></span>
<span><span class="co">##   in R. Bioinformatics 2014.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## This message can be suppressed by:</span></span>
<span><span class="co">##   suppressPackageStartupMessages(library(circlize))</span></span>
<span><span class="co">## ========================================</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a dendrogram</span></span>
<span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/mtcars.html" class="external-link">mtcars</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">hc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># modify the dendrogram to have some colors in the branches and labels</span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="va">dend</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span><span class="op">(</span>k<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="va">color_labels</span></span>
<span></span>
<span><span class="co"># plot the radial plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># circlize_dendrogram(dend, dend_track_height = 0.8) </span></span>
<span><span class="fu"><a href="../reference/circlize_dendrogram.html">circlize_dendrogram</a></span><span class="op">(</span><span class="va">dend</span>, labels_track_height <span class="op">=</span> <span class="cn">NA</span>, dend_track_height <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> </span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-12-1.png" width="750"></p>
</div>
<div class="section level3">
<h3 id="a-way-to-calculate-lowest-value-of-h-in-cut-that-produces-groupings-of-a-given-minimum-size">A way to calculate lowest value of h in cut that produces groupings
of a given minimum size?<a class="anchor" aria-label="anchor" href="#a-way-to-calculate-lowest-value-of-h-in-cut-that-produces-groupings-of-a-given-minimum-size"></a>
</h3>
<p>Asked (<a href="https://stackoverflow.com/questions/31124810/r-cut-dendrogram-into-groups-with-minimum-size/" class="external-link uri">https://stackoverflow.com/questions/31124810/r-cut-dendrogram-into-groups-with-minimum-size/</a>)[here].</p>
<p>Solution: use the <code>heights_per_k.dendrogram</code> function.</p>
<p>This feature is available in the dendextend package with the
<code>heights_per_k.dendrogram</code> function (which also has a faster
C++ implementation when loading the dendextendRcpp function).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,<span class="op">]</span><span class="op">)</span>, <span class="st">"ave"</span><span class="op">)</span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">hc</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heights_per_k.dendrogram.html">heights_per_k.dendrogram</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        1        2        3        4 </span></span>
<span><span class="co">## 86.47086 68.84745 45.98871 28.36531</span></span></code></pre>
<p>As a sidenote, the dendextend package has a
<code>cutree.dendrogram</code> S3 method for dendrograms (which works
very similarly to <code>cutree</code> for <code>hclust</code>
objects).</p>
</div>
<div class="section level3">
<h3 id="coloring-dendrograms-end-branches-or-leaves-based-on-column-number-of-data-frame-in-r">Coloring dendrogram’s end branches (or leaves) based on column
number of data frame in R<a class="anchor" aria-label="anchor" href="#coloring-dendrograms-end-branches-or-leaves-based-on-column-number-of-data-frame-in-r"></a>
</h3>
<p>Asked (<a href="https://stackoverflow.com/questions/30062187/coloring-dendrogram-s-end-branches-or-leaves-based-on-column-number-of-data-fr" class="external-link uri">https://stackoverflow.com/questions/30062187/coloring-dendrogram-s-end-branches-or-leaves-based-on-column-number-of-data-fr</a>)[here].</p>
<p>Solution: use the <code>assign_values_to_leaves_edgePar</code>
function.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">bb1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">11</span><span class="op">)</span></span>
<span><span class="va">aa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">bb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">data.main</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">aa1</span>,<span class="va">bb1</span>,<span class="va">aa2</span>,<span class="va">bb2</span><span class="op">)</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">data.main</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">hcl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span></span>
<span><span class="co"># plot(hcl1)</span></span>
<span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">hcl1</span><span class="op">)</span></span>
<span><span class="va">col_aa_red</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"aa"</span>, <span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span><span class="op">)</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="va">dend2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_values_to_leaves_edgePar.html">assign_values_to_leaves_edgePar</a></span><span class="op">(</span>dend<span class="op">=</span><span class="va">dend</span>, value <span class="op">=</span> <span class="va">col_aa_red</span>, edgePar <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend2</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-14-1.png" width="450"></p>
</div>
<div class="section level3">
<h3 id="color-side-bar-dendrogram-plot">Color side bar dendrogram plot<a class="anchor" aria-label="anchor" href="#color-side-bar-dendrogram-plot"></a>
</h3>
<p>Asked (<a href="https://stackoverflow.com/questions/34539746/color-side-bar-dendrogram-plot/" class="external-link uri">https://stackoverflow.com/questions/34539746/color-side-bar-dendrogram-plot/</a>)[here].</p>
<p>Solution: use the <code>color_branches</code> function.</p>
<p>Example using <code>mtcars</code>:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## mtcars example</span></span>
<span></span>
<span><span class="co"># Create the dend:</span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a vector giving a color for each car to which company it belongs to</span></span>
<span><span class="va">car_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Other"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">is_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Merc"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">car_type</span><span class="op">[</span><span class="va">is_x</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Mercedes"</span></span>
<span><span class="va">is_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Mazda"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">car_type</span><span class="op">[</span><span class="va">is_x</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Mazda"</span></span>
<span><span class="va">is_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Toyota"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">car_type</span><span class="op">[</span><span class="va">is_x</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Toyota"</span></span>
<span><span class="va">car_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">car_type</span><span class="op">)</span></span>
<span><span class="va">n_car_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">car_type</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cols_4</span> <span class="op">&lt;-</span> <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/rainbow_hcl.html" class="external-link">rainbow_hcl</a></span><span class="op">(</span><span class="va">n_car_types</span>, c <span class="op">=</span> <span class="fl">70</span>, l  <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">col_car_type</span> <span class="op">&lt;-</span> <span class="va">cols_4</span><span class="op">[</span><span class="va">car_type</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># extra: showing the various clusters cuts </span></span>
<span><span class="va">k234</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cutree-methods.html">cutree</a></span><span class="op">(</span><span class="va">dend</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># color labels by car company:</span></span>
<span><span class="fu"><a href="../reference/labels_colors.html">labels_colors</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">col_car_type</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/order.dendrogram.html" class="external-link">order.dendrogram</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># color branches based on cutting the tree into 4 clusters:</span></span>
<span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span><span class="op">(</span><span class="va">dend</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/colored_bars.html">colored_bars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">k234</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, <span class="va">col_car_type</span><span class="op">)</span>, <span class="va">dend</span>, rowLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"k = "</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"Car Type"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-15-1.png" width="450"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># horiz version:</span></span>
<span><span class="co"># dend &lt;- sort(dend)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/colored_bars.html">colored_bars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">k234</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, <span class="va">col_car_type</span><span class="op">)</span>, <span class="va">dend</span>, rowLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"k = "</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="st">"Car Type"</span><span class="op">)</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">car_type</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">cols_4</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-15-2.png" width="450"></p>
</div>
<div class="section level3">
<h3 id="plot-a-mirror-labels-on-the-left-horizontal-dendrogram">Plot a “mirror” (labels on the left) horizontal dendrogram<a class="anchor" aria-label="anchor" href="#plot-a-mirror-labels-on-the-left-horizontal-dendrogram"></a>
</h3>
<p>Asked (<a href="https://github.com/talgalili/dendextend/issues/29" class="external-link uri">https://github.com/talgalili/dendextend/issues/29</a>)[here].</p>
<p>Solution: use the <code>plot_horiz.dendrogram</code> function.</p>
<p>Example using <code>USArrests</code>:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the dend:</span></span>
<span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span>, <span class="st">"ave"</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="va">hc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/color_branches.html">color_branches</a></span><span class="op">(</span>k<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">color_labels</span></span>
<span></span>
<span><span class="co"># horiz normal version</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d</span>, horiz  <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-16-1.png" width="450"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># horiz mirror version</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_horiz.dendrogram.html">plot_horiz.dendrogram</a></span><span class="op">(</span><span class="va">d</span>, side <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="FAQ_files/figure-html/unnamed-chunk-16-2.png" width="450"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
