<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add colored dots beside a dendrogram — colored_dots • dendextend</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add colored dots beside a dendrogram — colored_dots"><meta property="og:description" content="Add colored dots next to a dendrogram, usually
corresponding to either clusters or some outside
categorization."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dendextend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.18.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/dendextend.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Cluster_Analysis.html">Hierarchical cluster analysis on famous data sets - enhanced with the _dendextend_ package</a>
    </li>
    <li>
      <a href="../articles/FAQ.html">Frequently asked questions</a>
    </li>
    <li>
      <a href="../articles/Quick_Introduction.html">Quick Introduction</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/talgalili/dendextend/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add colored dots beside a dendrogram</h1>
    <small class="dont-index">Source: <a href="https://github.com/talgalili/dendextend/blob/1.18.1/R/colored_dots.R" class="external-link"><code>R/colored_dots.R</code></a></small>
    <div class="hidden name"><code>colored_dots.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Add colored dots next to a dendrogram, usually
corresponding to either clusters or some outside
categorization.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">colored_dots</span><span class="op">(</span></span>
<span>  <span class="va">colors</span>,</span>
<span>  <span class="va">dend</span>,</span>
<span>  rowLabels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cex.rowLabels <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">y_scale</span>,</span>
<span>  <span class="va">y_shift</span>,</span>
<span>  text_shift <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sort_by_labels_order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  horiz <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dot_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="source">
    <h2>Source</h2>
    <p>This function is based on the <a href="https://rdrr.io/pkg/moduleColor/man/plotHclustColors.html" class="external-link">plotHclustColors</a> from the
moduleColor R package. It was modified so that it would
work with dendrograms (and not just hclust objects), as well allow to
add the colored dots on top of an existing plot (and not only as a seperate plot).</p>
<p>See: <a href="https://cran.r-project.org/package=moduleColor" class="external-link">https://cran.r-project.org/package=moduleColor</a>
For more details.</p>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>Coloring of the dots beside the dendrogram. Either a vector (one color per object)
or a matrix (can also be an array or a data frame)
with each column giving one group with color per object.
Each column will be plotted as a colored point (when horiz = FALSE)
under the dendrogram.
As long as the sort_by_labels_order paramter is TRUE (default), the colors vector/matrix should
be provided in the order of the original data order (and it will be re-ordered automatically to
the order of the dendrogram)</p></dd>


<dt id="arg-dend">dend<a class="anchor" aria-label="anchor" href="#arg-dend"></a></dt>
<dd><p>a dendrogram object. If missing, the colors are plotted without and re-ordering
(this assumes that the colors are already ordered based on the dend's labels)
This is also important in order to get the correct height/location of the colored dots
(i.e.: adjusting the y_scale and y_shift)</p></dd>


<dt id="arg-rowlabels">rowLabels<a class="anchor" aria-label="anchor" href="#arg-rowlabels"></a></dt>
<dd><p>Labels for the colorings given in <code>colors</code>. The labels will be printed to the
left of the color rows in the plot. If the argument is given, it must be a vector of length
equal to the number of columns in <code>colors</code>. If not given, <code>names(colors)</code>
will be used if available. If not, sequential numbers
starting from 1 will be used.</p></dd>


<dt id="arg-cex-rowlabels">cex.rowLabels<a class="anchor" aria-label="anchor" href="#arg-cex-rowlabels"></a></dt>
<dd><p>Font size scale factor for the row labels. See <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>logical(TRUE), should the colored dots be added to an existing
dendrogram plot?</p></dd>


<dt id="arg-y-scale">y_scale<a class="anchor" aria-label="anchor" href="#arg-y-scale"></a></dt>
<dd><p>how much should the dots be stretched on the y axis?
If no dend is supplied - the default will be 1</p></dd>


<dt id="arg-y-shift">y_shift<a class="anchor" aria-label="anchor" href="#arg-y-shift"></a></dt>
<dd><p>where should the dots be plotted underneath the x axis?
By default it will try to locate the dots underneath the labels (it may miss,
in which case you would need to enter a number manually)
If no dend is supplied - the default will be 0</p></dd>


<dt id="arg-text-shift">text_shift<a class="anchor" aria-label="anchor" href="#arg-text-shift"></a></dt>
<dd><p>a dendrogram object</p></dd>


<dt id="arg-sort-by-labels-order">sort_by_labels_order<a class="anchor" aria-label="anchor" href="#arg-sort-by-labels-order"></a></dt>
<dd><p>logical(TRUE) - if TRUE (default), then the order of the
colored dots will be sorted based on the order needed to change the original
order of the observations to the current order of the labels in the dendrogram.
If FALSE the colored dots are plotted as-is, based on the order
of the colors vector.</p></dd>


<dt id="arg-horiz">horiz<a class="anchor" aria-label="anchor" href="#arg-horiz"></a></dt>
<dd><p>logical (FALSE by default). Set to TRUE when using plot(dend, horiz = TRUE)</p></dd>


<dt id="arg-dot-size">dot_size<a class="anchor" aria-label="anchor" href="#arg-dot-size"></a></dt>
<dd><p>numeric (1 by default). Passed to cex argument in points</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>ignored at this point.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An invisible vector/matrix with the ordered colors.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The reason you might choose colored_dots over colored_bars is when you have
a lot of group types and/or a really large dendrogram.
Hint: Make a group for each categorical factor and color it one color when true,
and assign a fully transparent color when false.</p>
<p>You will often need to adjust the y_scale, y_shift and the text_shift
parameters, in order to get the dots in the location you would want.</p>
<p>(This can probably be done automatically, but will require more work.
since it has to do with the current mar settings,
the number of groups, and each computer's specific graphic device.
patches for smarter defaults will be appreciated)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="branches_attr_by_clusters.html">branches_attr_by_clusters</a>,
<a href="https://rdrr.io/pkg/WGCNA/man/plotDendroAndColors.html" class="external-link">plotDendroAndColors</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Steve Horvath <a href="mailto:SHorvath@mednet.ucla.edu">SHorvath@mednet.ucla.edu</a>,
Tal Galili <a href="mailto:Tal.Galili@gmail.com">Tal.Galili@gmail.com</a>,
Peter Langfelder <a href="mailto:Peter.Langfelder@gmail.com">Peter.Langfelder@gmail.com</a>,
Chase Clark <a href="mailto:chasec288@gmail.com">chasec288@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rows_picking</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">25</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="va">rows_picking</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">odd_numbers</span> <span class="op">&lt;-</span> <span class="va">rows_picking</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">[</span><span class="va">odd_numbers</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">colored_dots</span><span class="op">(</span><span class="va">cols</span>, <span class="va">dend</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="colored_dots-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Example of adjusting postion of dots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">colored_dots</span><span class="op">(</span><span class="va">cols</span>, <span class="va">dend</span>,</span></span>
<span class="r-in"><span>  y_shift <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>  rowLabels <span class="op">=</span> <span class="st">"Odd\n numbers"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="colored_dots-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rows_picking</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">25</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="va">rows_picking</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">odd_numbers</span> <span class="op">&lt;-</span> <span class="va">rows_picking</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="co"># For leaves that shouldn't have dots, make them the same color as the background,</span></span></span>
<span class="r-in"><span><span class="co"># or set the alpha value to fully transparant</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">[</span><span class="va">odd_numbers</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># scale is off</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">colored_dots</span><span class="op">(</span><span class="va">cols</span>, <span class="va">dend</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="colored_dots-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># move and scale a bit</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">colored_dots</span><span class="op">(</span><span class="va">cols</span>, <span class="va">dend</span>,</span></span>
<span class="r-in"><span>  y_shift <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>  rowLabels <span class="op">=</span> <span class="st">"Odd\n numbers"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="colored_dots-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Now let's cut the tree and add that info to the plot:</span></span></span>
<span class="r-in"><span><span class="va">k2</span> <span class="op">&lt;-</span> <span class="fu"><a href="cutree-methods.html">cutree</a></span><span class="op">(</span><span class="va">dend</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cols2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1b9e77"</span>, <span class="st">"#d95f02"</span><span class="op">)</span><span class="op">[</span><span class="va">k2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">colored_dots</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cols2</span>, <span class="va">cols</span><span class="op">)</span>, <span class="va">dend</span>,</span></span>
<span class="r-in"><span>  rowLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2 clusters"</span>, <span class="st">"Even numbers"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="colored_dots-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same, but with an horizontal plot!</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">colored_dots</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cols2</span>, <span class="va">cols</span><span class="op">)</span>, <span class="va">dend</span>,</span></span>
<span class="r-in"><span>  rowLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2 clusters"</span>, <span class="st">"Even numbers"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  horiz <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="colored_dots-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ==============================</span></span></span>
<span class="r-in"><span><span class="co"># ==============================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## mtcars example</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create the dend:</span></span></span>
<span class="r-in"><span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get all company names</span></span></span>
<span class="r-in"><span><span class="va">comp_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">" "</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get the top three occurring companies</span></span></span>
<span class="r-in"><span><span class="va">top_three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">comp_names</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Match the top three companies to where they are found in the dendrogram labels</span></span></span>
<span class="r-in"><span><span class="va">top_three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">top_three</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">top_three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">top_three</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># "top_three" is now a data frame of the top three companies as columns.</span></span></span>
<span class="r-in"><span><span class="co"># Each column represents a vector (rows) which is the length of labels(dend).</span></span></span>
<span class="r-in"><span><span class="co"># The vector has values TRUE and FALSE, for whether the company name matched</span></span></span>
<span class="r-in"><span><span class="co"># labels(dend)[i]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Colorblind friendly vector of HEX colors</span></span></span>
<span class="r-in"><span><span class="va">colorblind_friendly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1b9e77"</span>, <span class="st">"#d95f02"</span>, <span class="st">"#7570b3"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If we run the for-loop on "top_three" we will turn the vectors into a character-type too early,</span></span></span>
<span class="r-in"><span><span class="co"># so make a copy to "colored_dataframe" which we will work on</span></span></span>
<span class="r-in"><span><span class="va">colored_dataframe</span> <span class="op">&lt;-</span> <span class="va">top_three</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># This replaces TRUE values with a color from our vector of colors</span></span></span>
<span class="r-in"><span>  <span class="va">colored_dataframe</span><span class="op">[</span><span class="va">top_three</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">colorblind_friendly</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># This replaces FALSE values with black HEX, but fully transparent (invisible on plot)</span></span></span>
<span class="r-in"><span>  <span class="va">colored_dataframe</span><span class="op">[</span><span class="op">!</span><span class="va">top_three</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"#00000000"</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Color branches and labels by "cutting" the dendrogram at an arbitrary height</span></span></span>
<span class="r-in"><span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="color_branches.html">color_branches</a></span><span class="op">(</span><span class="va">dend</span>, h <span class="op">=</span> <span class="fl">170</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dend</span> <span class="op">&lt;-</span> <span class="fu"><a href="color_labels.html">color_labels</a></span><span class="op">(</span><span class="va">dend</span>, h <span class="op">=</span> <span class="fl">170</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### plots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">colored_dots</span><span class="op">(</span><span class="va">colored_dataframe</span>, <span class="va">dend</span>,</span></span>
<span class="r-in"><span>  rowLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">colored_dataframe</span><span class="op">)</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, sort_by_labels_order <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Show a dotted line where tree was "cut"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">170</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="colored_dots-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># horiz version:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dend</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">colored_dots</span><span class="op">(</span><span class="va">colored_dataframe</span>, <span class="va">dend</span>,</span></span>
<span class="r-in"><span>  rowLabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">colored_dataframe</span><span class="op">)</span>, horiz <span class="op">=</span> <span class="cn">TRUE</span>, sort_by_labels_order <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Show a dotted line where the tree was "cut"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">170</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="colored_dots-8.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tal Galili, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

